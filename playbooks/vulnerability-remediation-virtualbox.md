# Vulnerability Remediation Playbook: Oracle VirtualBox CVEs
**Type:** Software Patch Management / Virtualization Infrastructure  
**Tooling:** Wazuh (detection) + Chocolatey/Oracle Installer (remediation)  
**Difficulty:** Beginner  
**Estimated Time:** 15-30 minutes  
**Last Updated:** 2026-02-02

---

## üéØ Learning Objectives

After completing this playbook, you should understand:
1. How virtualization software vulnerabilities are tracked and disclosed
2. The Oracle Critical Patch Update (CPU) cycle and CVE numbering
3. How to safely update hypervisors without destroying VM data
4. Why staying current on hypervisor patches is critical for host security

**Prerequisites:** Basic PowerShell, understanding of virtualization concepts

---

## üìã Overview

Remediate Oracle VirtualBox CVEs detected by Wazuh vulnerability scanner. VirtualBox 7.2.4 had 14 disclosed vulnerabilities (11 High, 3 Medium severity) patched in version 7.2.6.

**Real-World Example:** Production workstation `gandalf` (Agent 001) running VirtualBox 7.2.4 flagged with fresh CVEs from January 2026 Oracle CPU. Updated to 7.2.6 to clear exposure.

---

## üö® Detection (Wazuh)

### Alert Signature
- **Rule Group:** `vulnerability-detector`
- **package.name:** `Oracle VirtualBox 7.2.4`
- **severity:** High (11), Medium (3)
- **cve:** CVE-2026-21989, CVE-2026-21988, CVE-2026-21990, CVE-2026-21984, CVE-2026-21957, CVE-2026-21955, CVE-2026-21987, CVE-2026-21956, CVE-2026-21986, CVE-2026-21982, CVE-2026-21983 (High); CVE-2026-21963, CVE-2026-21981, CVE-2026-21985 (Medium)

### Dashboard Query
```
vulnerability.severity: (High OR Medium)
package.name: "Oracle VirtualBox*"
```

### Initial Triage Questions
1. Are there active VMs on this host? ‚Üí Check running VMs before update
2. Is this VirtualBox instance actively used? ‚Üí If not, consider removal
3. What's the latest patched version? ‚Üí Check Oracle VirtualBox downloads

---

## üîç Investigation

### Why This Step Matters
VirtualBox is a Type 2 hypervisor with deep host integration. Vulnerabilities can allow VM escape, host compromise, or denial of service. The January 2026 CPU addressed 14 CVEs - a significant patch bundle.

### Step 1: Verify Current Version
```powershell
# Check installed VirtualBox version
Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | 
    Where-Object {$_.DisplayName -like "*VirtualBox*"} | 
    Select DisplayName, DisplayVersion

# Alternative: Check VirtualBox executable
& "C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" --version
```

**Expected Output:** Version 7.2.4 (or similar outdated version)

### Step 2: Check for Active VMs
```powershell
# List all VMs (running and stopped)
& "C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" list vms

# Check which VMs are currently running
& "C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" list runningvms
```

**Key Insight:** If VMs are running, you'll need to shut them down before updating.

### Step 3: Document VM State
```powershell
# Export VM list for reference
& "C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" list vms > C:\temp\virtualbox-vms-pre-update.txt
```

---

## üõ†Ô∏è Remediation

### Option A: Update via Chocolatey (Recommended)

**When to use:** Chocolatey was used for original installation, or you want automated dependency handling.

```powershell
# Upgrade VirtualBox to latest
choco upgrade virtualbox -y

# Verify installation
& "C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" --version
# Expected: 7.2.6 (or newer)
```

**Trade-offs:** 
- ‚úÖ Automatic dependency handling
- ‚úÖ Silent installation
- ‚ö†Ô∏è May install Oracle Extension Pack separately if needed

### Option B: Manual Download and Install

**When to use:** You want full control, or need specific version.

```powershell
# Download latest VirtualBox (PowerShell)
$downloadUrl = "https://download.virtualbox.org/virtualbox/7.2.6/VirtualBox-7.2.6-Win.exe"
$outPath = "$env:TEMP\VirtualBox-7.2.6.exe"
Invoke-WebRequest -Uri $downloadUrl -OutFile $outPath

# Silent install
& $outPath --silent
```

**Trade-offs:**
- ‚úÖ Full control over version
- ‚úÖ Can bundle Extension Pack
- ‚ö†Ô∏è Manual download required

### Option C: Remove VirtualBox (If Unused)

**When to use:** VirtualBox isn't actively used on this host.

```powershell
# Uninstall VirtualBox
choco uninstall virtualbox -y
# Or via Windows Settings
```

**Trade-offs:**
- ‚úÖ Removes all 14 CVEs instantly
- ‚ö†Ô∏è VMs must be migrated or deleted first

---

## ‚úÖ Verification

### Immediate Check
```powershell
# Confirm updated version
& "C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" --version
# Expected: 7.2.6

# Verify VMs still accessible
& "C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" list vms
```

### Wazuh Confirmation
```powershell
# Restart Wazuh agent to trigger fresh scan
Restart-Service -Name "Wazuh"
```

Wait 5-15 minutes for next vulnerability scan cycle, then check Wazuh dashboard or run CSV export:

```
Source: wazuh-states-vulnerabilities-*
Filter: agent.name: Gandalf AND package.name: "Oracle VirtualBox*"
Expected: 0 results (or only newer CVEs if any)
```

### CSV Verification (Portfolio Evidence)
Generated report from saved search:
- **Before:** 14 VirtualBox CVEs (11 High, 3 Medium)
- **After:** 0 VirtualBox CVEs detected
- **Timestamp:** [Update date]

---

## üìù Post-Remediation

### Documentation Checklist
- [ ] Record VirtualBox version update (7.2.4 ‚Üí 7.2.6)
- [ ] Verify all VMs functional post-update
- [ ] Update asset inventory with new version
- [ ] Save CSV report as evidence

### Prevention
- [ ] Enable Chocolatey automatic upgrade checks: `choco outdated`
- [ ] Subscribe to Oracle Security Alerts: https://www.oracle.com/security-alerts/
- [ ] Add VirtualBox to monthly patch cycle
- [ ] Consider Hyper-V migration for better Windows integration

---

## üß† Lessons Learned

| Issue | Root Cause | Prevention |
|-------|-----------|------------|
| 14 CVEs accumulated | No VirtualBox update cadence | Monthly `choco upgrade` or subscribe to Oracle CPU |
| Hypervisor exposure | Type 2 hypervisor on production workstation | Evaluate if VMs needed on this host; consider dedicated hypervisor |
| Delayed patching | No automated vulnerability scanning pre-update | Wazuh alerting + playbook-driven response |

---

## üìö References

- **Case Study:** Gandalf (Agent 001) - VirtualBox 7.2.4 ‚Üí 7.2.6 (Feb 2026)
- **Oracle Security:** https://www.oracle.com/security-alerts/
- **VirtualBox Downloads:** https://www.virtualbox.org/wiki/Downloads
- **Related Playbooks:** 
  - [vulnerability-remediation-software.md](./vulnerability-remediation-software.md)
  - [vulnerability-remediation-nodejs.md](./vulnerability-remediation-nodejs.md)

---

## üìä Playbook Metrics

| Date | Action | Analyst | Time Spent | Notes |
|------|--------|---------|------------|-------|
| 2026-02-02 | VirtualBox 7.2.4 ‚Üí 7.2.6 | solomon | 15 min | 14 CVEs cleared, all VMs functional |

---

*Template for virtualization software vulnerability remediation. Adapt version numbers as needed.*
