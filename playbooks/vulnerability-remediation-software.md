# Vulnerability Remediation Playbook: Outdated Software
**Type:** Vulnerability Management / Software Deployment Validation  
**Tooling:** Wazuh (detection) + Active Directory GPO (remediation)  
**Last Updated:** 2026-02-02

---

## Overview
Standardized response for CVE alerts triggered by outdated software deployments across the fleet.

**Example Case:** Adobe Acrobat 2015 deployed via SCCM, flagged by Wazuh CVE scanning on all student machines.

---

## Detection (Wazuh)

### Alert Signature
- **Rule ID:** Varies (CVE-related rules)
- **Description:** Software vulnerability detected
- **Fields:** `data.vulnerability.package.name`, `data.vulnerability.package.version`, `data.vulnerability.cve`

### Initial Query
```sql
-- Find all affected assets
SELECT agent_name, data->>'vulnerability.package.name' as software,
       data->>'vulnerability.package.version' as version,
       data->>'vulnerability.cve' as cve
FROM alerts 
WHERE rule_group LIKE '%vulnerability%' 
  AND data->>'vulnerability.package.name' = 'Adobe Acrobat'
GROUP BY agent_name;
```

### Triage Questions
1. What software/version is triggering? → Check `package.version` field
2. How many assets affected? → Count unique agent_id
3. Is this software business-critical? → Check with asset owner
4. Is latest version actually available? → Verify against vendor/Windows Store

---

## Investigation

### Step 1: Verify Current Version
```powershell
# Run on sample affected machine
Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | 
    Where-Object {$_.DisplayName -like "*Adobe*"} | 
    Select DisplayName, DisplayVersion
```

### Step 2: Check Windows Store for Current Version
- Open Microsoft Store
- Search for software
- Compare version numbers
- Note: Store versions often newer than vendor installers

### Step 3: Identify Deployment Source
- Check SCCM/WSUS for deployment history
- Identify who/what deployed outdated version
- Document for post-incident review

---

## Remediation

### Option A: GPO-Based Removal + Reinstall (Preferred for mass deployment)

**Step 1: Create GPO for Software Removal**
- [ ] Open Group Policy Management
- [ ] Create new GPO: "Remove [Software] - Vuln Remediation"
- [ ] Link to affected OU
- [ ] Navigate to: Computer Configuration → Policies → Software Settings → Software Installation
- [ ] Set deployment to **Uninstall** mode
- [ ] Force removal of existing installations

**Step 2: Script Windows Store Installation**
```powershell
# Install from Windows Store via PowerShell
# Requires Windows 10/11 1809+ with App Installer

$appId = "9WZDNCRFJ10C"  # Adobe Acrobat Reader (verify correct ID)
winget install --id $appId --silent --accept-package-agreements

# Alternative: Use Add-AppxPackage if offline package available
# Add-AppxPackage -Path "\\server\share\AdobeReader.msixbundle"
```

**Step 3: Verification Script**
```powershell
# Check installed version post-remediation
$installed = Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | 
    Where-Object {$_.DisplayName -like "*Adobe Acrobat*"}

if ($installed.DisplayVersion -ge "23.0") {  # Update with actual latest
    Write-Host "[PASS] Current version installed: $($installed.DisplayVersion)"
} else {
    Write-Host "[FAIL] Outdated or missing: $($installed.DisplayVersion)"
}
```

### Option B: Manual Remediation (Single/Testing)
- [ ] Uninstall via Control Panel/Settings
- [ ] Run vendor cleanup tool if available (Adobe Cleaner Tool)
- [ ] Reboot
- [ ] Install latest from Windows Store

---

## Verification

### Wazuh Confirmation
- Wait for next vulnerability scan cycle (or force scan)
- Query for resolved CVEs:
```sql
SELECT agent_name, data->>'vulnerability.cve' as cve,
       data->>'vulnerability.status' as status
FROM alerts 
WHERE data->>'vulnerability.cve' IN ('CVE-XXXX-XXXXX', 'CVE-XXXX-XXXXX')
  AND timestamp > NOW() - INTERVAL '1 day';
```

### Manual Spot Checks
- [ ] Random sample of 5-10 machines
- [ ] Verify correct version installed
- [ ] Test basic functionality

---

## Post-Incident

### Documentation
- [ ] Record GPO settings used (see: [PENDING] GPO details to be added)
- [ ] Save PowerShell scripts to shared location
- [ ] Update software inventory database

### Process Improvements
- [ ] Add software deployment validation step to change process
- [ ] Implement pre-deployment CVE check
- [ ] Review SCCM/WSUS auto-approval rules
- [ ] Create software baseline validation procedure

### Communication
- [ ] Notify affected users of software change
- [ ] Document in change log
- [ ] Update asset owner on remediation status

---

## Lessons Learned (Adobe Case)

| Issue | Root Cause | Prevention |
|-------|-----------|------------|
| 2015 version deployed | SCCM deployment outdated | Verify "latest" claim against vendor site |
| Mass CVE alerts | No pre-deployment scanning | Add vulnerability scan to deployment workflow |
| Delayed remediation | No documented procedure | This playbook |

---

## References

- **Case Study:** Adobe Acrobat 2015 → Windows Store latest (Feb 2026)
- **Tools:** Wazuh Vulnerability Detector, Group Policy, Windows Store, winget
- **External:** MITRE CVE database, Adobe Security Bulletins

---

## Playbook History

| Date | Action | Analyst |
|------|--------|---------|
| 2026-02-02 | Initial draft created | clawdbot |
| [PENDING] | Add specific GPO settings | solomon |
| [PENDING] | Add exact PowerShell script paths | solomon |
| [PENDING] | Test and validate procedure | solomon |

---

*Template for Wazuh-detected software vulnerabilities. Adapt per software type.*
